---
title: 浏览器强缓存与协商缓存
date: 2021-12-07 00:35:41
tags: 浏览器
categories: 浏览器
---

# 强缓存

> 强缓存的作用是，当浏览器请求某个文件的时候，如果缓存中的资源没有过期，则浏览器不会去询问服务器，而是使用缓存中的资源。

与强缓存有关的字段是`Response Headers`中的`cache-control`头部，

常见的字段有：

- max-age：缓存过期时间
- public：表示可以被浏览器和代理服务器缓存
- immutable：表示此资源永远不变，设置了这个的话，即使用户强制刷新，浏览器也不会对服务器发出请求
- private：表示浏览器可以缓存、代理服务器不能缓存
- no-cache：跳过设置强缓存，但是不妨碍设置协商缓存，如果设置了这个字段，则每次请求都会询问服务端
- no-store：客户端和服务器都不缓存

# 协商缓存

在`response header`中，有一个`etag`字段，是这个文件的hash值。当强缓存过期时，浏览器发出请求时会携带这个过期资源的`etag`，然后服务端将这个`etag`与服务端资源做对比判断资源是否有更改，如果有更改就返回新资源跟状态码**200**，没更改就返回**304**状态码，然后浏览器使用旧的资源


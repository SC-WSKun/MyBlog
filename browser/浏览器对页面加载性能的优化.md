---
title: 浏览器对页面加载性能的优化
date: 2022-03-06 17:07:22
tags: 浏览器
categories: 浏览器
---

> 参考：《Web性能权威指南》

# 主要对什么进行优化

首先我们要明白，带宽再高，对页面加载速度的影响也是有限的，因为在日常使用中是以频繁的HTTP小型突发性数据流为主，带宽提高主要是优化大块数据的传输，对于我们日常的Web应用的提升微乎其微。

所以我们需要优化的主要是**网络延迟**，回顾用户输入URL后浏览器的行为，我们知道首先要DNS解析，TCP连接，TLS握手，资源请求等等等。在传输数据文件之前的这些请求就是造成页面加载延迟的主要因素。

所以我们的核心思路就是：优化传输数据前的这些底层协议行为。

# 浏览器优化的方式

{% note info %}

从核心优化策略来说，优化可以分为两类：

- **基于文档的优化：**

  熟悉网络协议，了解文档、CSS和JavaScript解析管道，发现和优先安排关键网络资源，让用户能尽快与页面进行交互。主要方法是优先获取资源、提前解析等。

- **推测性优化：**

  根据用户的导航模式，执行推测性优化，尝试预测用户的下一次操作，然后预先解析DNS、预先连接可能的目标

{% endnote %}

大多数浏览器使用了以下的四种技术：

- 资源预取和排定优先顺序：

  文档、CSS和JavaScript解析器可以与网络协议层沟通，声明每种资源的优先级：

  - 初始渲染必须的阻塞资源具有最高优先级
  - 低优先级的请求可能会被临时保存在队列中

- DNS预解析：

  对可能的域名进行提前解析，避免将来HTTP请求时的DNS延迟。预解析可以通过学习导航历史、用户的鼠标悬停或其他页面信号来触发。

- TCP预连接：

  DNS解析之后，浏览器可以根据预测的HTTP请求，推测性地打开TCP连接。

- 页面预渲染：

  某些浏览器可以让我们提示下一个可能的目标，从而在隐藏的标页中预先渲染整个页面。这样当用户真的触发导航时可以立即切换过来。
